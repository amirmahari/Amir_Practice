from mlxtend.plotting import heatmap
import numpy as np
import pandas as pd
import seaborn as sb
import matplotlib.pyplot as plt
import seaborn as sns


def create_heatmap(data, xticks_labels):
    fig, ax = plt.subplots(figsize=(30, 20))

    ax.xaxis.tick_top()

    sns.set(font_scale=1.4)
    res = sns.heatmap(data, annot=False, vmin=0, vmax=1, fmt='.2f', linewidths=0.1, linecolor='grey', cmap='Greys')

    res.set_xticklabels(xticks_labels, fontsize=14, rotation=90)

    plt.yticks(ticks=[(i + 0.5) for i in range(len(data))], labels=['%d' % (i + 1) for i in range(len(data))],
               rotation=0, fontsize=14)

    plt.ylabel('Iteration', fontsize=14)

    plt.show()


vals=np.array([[1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],
               [1.0,0.5,0.0,0.0,0.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],
               [1.0,0.5,0.0,0.0,0.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.0,0.0,0.0,0.0,0.0,0.0],
               [1.0,0.5,0.5,0.0,0.5,0.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,0.0,0.5,0.5,0.0,0.0],
               [1.0,0.5,0.5,0.5,0.5,0.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,0.5,0.5,0.5,0.0,0.0],
               [1.0,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,0.5,0.5,0.5,0.0,0.0],
               [1.0,0.5,0.5,0.5,0.5,0.5,0.0,0.5,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,0.5,0.5,0.5,0.0,0.0],
               [0.0,0.5,0.5,0.5,0.5,0.5,0.0,0.5,1.0,1.0,0.0,0.3,0.3,0.3,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,0.5,0.5,0.5,0.5,0.0],
               [0.0,0.0,0.5,0.5,0.5,0.5,0.0,0.5,1.0,1.0,0.0,0.3,0.3,0.3,0.3,0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,0.5,0.5,0.5,0.5,0.0],
               [0.0,0.0,0.0,0.5,0.0,0.5,0.0,0.0,1.0,1.0,0.0,0.3,0.3,0.3,0.3,0.3,0.0,0.3,0.0,0.0,0.0,0.5,0.5,0.5,0.5,0.5,0.5,0.0],
               [0.0,0.0,0.0,0.0,0.0,0.5,0.0,0.0,1.0,1.0,0.0,0.0,0.3,0.0,0.3,0.3,0.3,0.3,0.0,0.0,0.0,0.5,0.5,0.5,0.5,0.5,0.5,0.0],
               [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.3,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.5,0.5,0.5,0.5,0.5,0.5,0.0],
               [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.3,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,0.5,0.5,0.5,0.0,0.5],
               [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.3,0.0,0.0,0.0,0.0,0.0,0.0,0.3,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5],
               [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.3,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5],
               [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],
               [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.5]])


xlabels=['ICL','FANCM','FAcore','FANCD2I','MUS81','FANCJBRCA1','XPF','FAN1','ADD','DSB','PCNATLS','MRN','BRCA1','ssDNARPA','FANCD1N','RAD51',
                                    'HRR','USP1','KU','DNAPK','NHEJ','ATR','ATM','p53','CHK1','CHK2','H2AX','CHKREC']


create_heatmap(vals,xlabels)



